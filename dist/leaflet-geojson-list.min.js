/* 
 * Leaflet GeoJSON List v0.0.6 - 2015-03-19 
 * 
 * Copyright 2015 Stefano Cudini 
 * stefano.cudini@gmail.com 
 * http://labs.easyblog.it/ 
 * 
 * Licensed under the MIT license. 
 * 
 * Demo: 
 * http://labs.easyblog.it/maps/leaflet-geojson-list/ 
 * 
 * Source: 
 * git@github.com:stefanocudini/leaflet-geojson-list.git 
 * 
 */
(function(){L.Control.GeoJSONList=L.Control.extend({includes:L.Mixin.Events,options:{collapsed:!1,label:"name",zoomOn:"click",position:"bottomleft",styleActive:{color:"#00f",fillColor:"#fa0",weight:1,opacity:1,fillOpacity:.6}},initialize:function(a,b){L.Util.setOptions(this,b),this._layer=a},onAdd:function(a){this._map=a;var b=L.DomUtil.create("div","geojson-list");return this._container=b,this._list=L.DomUtil.create("ul","geojson-list-ul",b),this._initToggle(),this._updateList(),L.DomEvent.on(b,"mouseover",function(){a.scrollWheelZoom.disable()}).on(b,"mouseout",function(){a.scrollWheelZoom.enable()}),a.whenReady(function(a){b.style.height=a.getSize().y+"px"}),b},onRemove:function(a){a.off("moveend",this._updateList,this)},_createItem:function(a){var b=L.DomUtil.create("li","geojson-list-li"),c=L.DomUtil.create("a","",b),d=this;return c.href="#",L.DomEvent.disableClickPropagation(c).on(c,this.options.zoomOn,L.DomEvent.stop,this).on(c,this.options.zoomOn,function(){d._moveTo(a),d.fire("item-zoomon",{layer:a})},this).on(c,"mouseover",function(){a.setStyle(d.options.styleActive),d.fire("item-mouseover",{layer:a})},this).on(c,"mouseout",function(){d._layer.resetStyle(a),d.fire("item-mouseout",{layer:a})},this),a.feature.properties.hasOwnProperty(this.options.label)?c.innerHTML="<span>"+a.feature.properties[this.options.label]+"</span>":console.log("propertyName '"+this.options.label+"' not found in feature"),b},_updateList:function(){var a=this;this._list.innerHTML="",this._layer.eachLayer(function(b){a._list.appendChild(a._createItem(b))})},_initToggle:function(){var a=this._container;if(a.setAttribute("aria-haspopup",!0),L.Browser.touch?L.DomEvent.on(a,"click",L.DomEvent.stopPropagation):L.DomEvent.disableClickPropagation(a),this.options.collapsed){this._collapse(),L.Browser.android||L.DomEvent.on(a,"mouseover",this._expand,this).on(a,"mouseout",this._collapse,this);var b=this._button=L.DomUtil.create("a","geojson-list-toggle",a);b.href="#",b.title="List GeoJSON",L.Browser.touch?L.DomEvent.on(b,"click",L.DomEvent.stop).on(b,"click",this._expand,this):L.DomEvent.on(b,"focus",this._expand,this),this._map.on("click",this._collapse,this)}},_expand:function(){this._container.className=this._container.className.replace(" geojson-list-collapsed","")},_collapse:function(){L.DomUtil.addClass(this._container,"geojson-list-collapsed")},_moveTo:function(a){this._map.fitBounds(a.getBounds().pad(1))}}),L.control.geoJsonList=function(a){return new L.Control.GeoJSONList(a)}}).call(this);